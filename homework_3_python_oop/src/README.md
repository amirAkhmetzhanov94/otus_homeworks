# üß† Scoring API

–ú–∏–Ω–∏-—Å–µ—Ä–≤–∏—Å –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ HTTP POST-–∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ —Å–∫–æ—Ä–∏–Ω–≥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤ –ø–æ id.  
–ó–∞–¥–∞–Ω–∏–µ –∏–∑ –∫—É—Ä—Å–∞ OTUS.

---

## üöÄ –ó–∞–ø—É—Å–∫

```bash
python api.py -p 8080
```

–î–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ —Ñ–∞–π–ª:

```bash
python api.py -p 8080 -l my_log_file.txt
```

---

## üß™ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –∏ —É –≤–∞—Å –µ—Å—Ç—å —Ñ–∞–π–ª `test.py`.  
–î–ª—è –∑–∞–ø—É—Å–∫–∞ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤:

```bash
python test_1.py
```

–î–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞:

```bash
python -m unittest test_1.py -v
```

---

## üîë –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

* –î–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Ç–æ–∫–µ–Ω = `sha512(account + login + SALT)`
* –î–ª—è –∞–¥–º–∏–Ω–∞ —Ç–æ–∫–µ–Ω = `sha512(datetime.now().strftime("%Y%m%d%H") + ADMIN_SALT)`
* `SALT = "Otus"`, `ADMIN_SALT = "42"`

---

## üß™ –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

### `online_score`

```bash
curl -X POST -H "Content-Type: application/json" \
-d '{
  "account": "horns&hoofs",
  "login": "h&f",
  "method": "online_score",
  "token": "<valid_token>",
  "arguments": {
    "phone": "79175002040",
    "email": "stupnikov@otus.ru"
  }
}' http://127.0.0.1:8080/method/
```

–û—Ç–≤–µ—Ç:

```json
{"code": 200, "response": {"score": 5.0}}
```

–î–ª—è –∞–¥–º–∏–Ω–∞:

```json
{"code": 200, "response": {"score": 42}}
```

---

### `clients_interests`

```bash
curl -X POST -H "Content-Type: application/json" \
-d '{
  "account": "horns&hoofs",
  "login": "admin",
  "method": "clients_interests",
  "token": "<admin_token>",
  "arguments": {
    "client_ids": [1, 2, 3],
    "date": "01.01.2023"
  }
}' http://127.0.0.1:8080/method/
```

–û—Ç–≤–µ—Ç:

```json
{"code": 200, "response": {"1": ["books", "hi-tech"], "2": ["pets", "tv"], "3": ["travel", "music"]}}
```

---

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

* `api.py` ‚Äî –≥–ª–∞–≤–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
* `scoring.py` ‚Äî –ª–æ–≥–∏–∫–∞ —Å–∫–æ—Ä–∏–Ω–≥–∞ –∏ –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤
* `exceptions.py` ‚Äî –∏—Å–∫–ª—é—á–µ–Ω–∏—è
* `test.py` ‚Äî —Ç–µ—Å—Ç—ã

---

## üß† –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

* –ú–µ—Ç–∞–∫–ª–∞—Å—Å —Å–æ–±–∏—Ä–∞–µ—Ç –ø–æ–ª—è –º–æ–¥–µ–ª–∏ –∑–∞–ø—Ä–æ—Å–∞
* –ü–æ–¥–¥–µ—Ä–∂–∫–∞ nullable –∏ required –ø–æ–ª–µ–π
* –û–±—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–ø—Ä–æ—Å–∞ ‚Äî –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–∞—è –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º–∞—è
* –û—Ç–≤–µ—Ç—ã —Å—Ç—Ä–æ–≥–æ –ø–æ —Ñ–æ—Ä–º–∞—Ç—É `{"code": ..., "response": ...}` –∏–ª–∏ `{"error": ..., "code": ...}`
